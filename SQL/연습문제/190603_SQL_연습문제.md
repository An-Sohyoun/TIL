[ 문제 1 ]

연도별 직업별 SAL의 평균

1981년 입사한 사람 중 부서10과 20에 속한 사람

그 중 평균 SAL이 1500 이상인 사람의 평균 SAL을 출력

```SQL
SELECT TO_CHAR(HIREDATE,'YYYY') AS 연도, JOB, AVG(SAL) FROM EMP
WHERE DEPTNO IN (10,20)
GROUP BY TO_CHAR(HIREDATE,'YYYY'), JOB
HAVING TO_CHAR(HIREDATE,'YYYY') = '1981' AND AVG(SAL)>=1500
ORDER BY JOB;
```

[ 문제 2 ]

JOB별 SALARY의 평균을 구하고

평균이 2000 이상인 그룹 중에서 

가장 큰 평균을 갖는 그룹과 가장 작은 평균을 갖는 그룹의 액수를각각 출력

```SQL
SELECT MAX(AVG(SAL)) AS MAX_AVG, MIN(AVG(SAL)) AS MIN_AVG
FROM EMP
GROUP BY JOB
HAVING AVG(SAL) >= 2000;
```

[ 문제 3 ]

입사한 달로 사원들을 그룹짓고

DEPTNO가 20 또는 30이고 4,5,12월에 입사한 사원들의 평균 임금을 출력

MONTH를 기준으로 오름차순 정렬

```sql
SELECT TO_CHAR(HIREDATE,'MM') AS MONTH, AVG(SAL) FROM EMP
WHERE DEPTNO IN (20,30)
GROUP BY TO_CHAR(HIREDATE,'MM')
HAVING TO_CHAR(HIREDATE,'MM') IN (4,5,12)
ORDER BY MONTH;
```

[ 문제 4 ]

직업별 입사 월별 월급의 최대 값을 출력

단, 이름에 'S'가 들어가고 입사 월이 12월인 사람을 대상으로 함

```sql
SELECT JOB, TO_CHAR(HIREDATE,'MM') AS MONTHS, MAX(SAL) AS MAX FROM EMP
WHERE ENAME LIKE '%S%'
GROUP BY TO_CHAR(HIREDATE,'MM'), JOB
HAVING TO_CHAR(HIREDATE,'MM')='12'
```

[ 문제 5 ]

고용 월별, 직업별로 SAL+COMM의 평균을 출력

SAL+COMM의 평균이 2000 이상이며, ENAME에 'A'가 있는 경우 

고용월별을 기준으로 내림차순 정렬

```SQL
SELECT JOB,TO_CHAR(HIREDATE,'MM') AS MM, AVG(SAL+NVL(COMM,0))AS MEAN FROM EMP
WHERE ENAME LIKE '%A%'
GROUP BY TO_CHAR(HIREDATE,'MM'), JOB
HAVING AVG(SAL+NVL(COMM,0)) >= 2000
ORDER BY MM DESC;
```

[ 문제 6 ]

EMP 테이블에서 JOB별, MGR별 ENAME

단, HIREDATE가 9월,12월이며 MGR은 7698 

 JOB을 기준으로 오름차순 정렬

```sql
SELECT JOB, MGR, ENAME FROM EMP
WHERE TO_CHAR(HIREDATE, 'MM') IN (09,12)
GROUP BY JOB, MGR, ENAME
HAVING MGR = 7698
ORDER BY JOB;
```

[ 문제 7 ] 

DALLAS에 근무하고 있는 MANAGER가 관리하는 직원의 EMPNO, ENAME, 연봉, 부서이름을 출력

```sql
SELECT e.EMPNO, e.ENAME, 
SAL*12 AS ASAL, d.DNAME FROM EMP e, DEPT d 
WHERE e.DEPTNO = d.DEPTNO
AND MGR IN(
SELECT EMPNO FROM EMP
WHERE DEPTNO =
(SELECT DEPTNO FROM DEPT 
 WHERE LOC = 'DALLAS'
 AND JOB = 'MANAGER')
);
```

[ 문제 8 ]

상사랑 다른 지역에서 일하는 사람을 출력 (단, KING은 제외)

```sql
SELECT e.ENAME, d.LOC FROM EMP e, DEPT d
WHERE e.DEPTNO = d.DEPTNO
AND e.ENAME NOT IN ('KING')
AND e.MGR IN (
SELECT e2.EMPNO FROM EMP e2, DEPT d2
WHERE NOT (d.LOC = d2.LOC)
AND e2.DEPTNO = d2.DEPTNO
);
```

[ 문제 9 ]

연도와 지역이 같은 사람 중 

월급의 최댓값과 비교했을 때 차이가 500 이하인 사람들의 ENAME, JOB, SAL을 출력

```sql
SELECT ENAME, JOB, SAL FROM EMP e1, DEPT d1
WHERE e1.DEPTNO = d1.DEPTNO 
AND SAL <= (
SELECT MAX(SAL) - 500 FROM EMP e2, DEPT d2
WHERE e2.DEPTNO = d2.DEPTNO
GROUP BY LOC, TO_CHAR(HIREDATE,'YYYY')
HAVING d1.LOC = d2.LOC
AND TO_CHAR(e1.HIREDATE,'YYYY') = TO_CHAR(e2.HIREDATE,'YYYY')
);
```

```SQL
SELECT ENAME, JOB, SAL FROM EMP e1, DEPT d1
WHERE e1.DEPTNO = d1.DEPTNO 
AND SAL <= (
SELECT MAX(SAL) - 500 FROM EMP e2, DEPT d2
WHERE e2.DEPTNO = d2.DEPTNO
AND d1.LOC = d2.LOC
AND TO_CHAR(e1.HIREDATE,'YYYY') = TO_CHAR(e2.HIREDATE,'YYYY')
GROUP BY LOC, TO_CHAR(HIREDATE,'YYYY')
);
```

[ 문제 10 ]

DALLAS 지역에서 근무하고, 

1980년과 1981년도에 입사한 사람들의 ENAME, ANNSAL, JOB을 출력 (단, ANNSAL은 'SAL*12'로 계산)

````sql
SELECT ENAME, 
SAL * 12 AS ANNSAL, 
JOB FROM EMP e, DEPT d
WHERE e.DEPTNO = d.DEPTNO 
AND LOC IN ('DALLAS')
AND TO_CHAR(HIREDATE,'YYYY') IN (1980,1981);
````

[ 문제 11 ] 

부하직원을 가장 많이 데리고 있는 사람의 ENAME, JOB, LOC을 출력 (MGR은 상사의 EMPNO를 나타낸다고 가정)

```sql
SELECT ENAME, JOB, LOC FROM EMP e, DEPT d
WHERE e.DEPTNO = d.DEPTNO
AND EMPNO IN (
SELECT MGR FROM EMP e2 
GROUP BY e2.MGR
HAVING COUNT(e2.MGR) =  (
SELECT MAX(COUNT(e3.MGR)) FROM EMP e3
GROUP BY e3.MGR)
);
```

[ 문제 12 ]

입사년도별로 월급을 가장 많이 받은 사람의 이름, SAL, 입사년도, 근속연수 출력

```sql
SELECT ENAME, SAL, 
TO_CHAR(HIREDATE,'YYYY') AS EMPYEAR, 
TRUNC(MONTHS_BETWEEN(SYSDATE,HIREDATE)/12,0) AS YEARS FROM EMP e
WHERE SAL >= (
SELECT MAX(SAL) FROM EMP e2
WHERE TO_CHAR(e.HIREDATE,'YYYY') = TO_CHAR(e2.HIREDATE,'YYYY')
GROUP BY TO_CHAR(HIREDATE,'YYYY')
);
```

